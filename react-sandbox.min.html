<!DOCTYPE html><html><head><meta charset="UTF-8"><title>React 18 + TS Monaco Sandbox</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#1e1e1e;color:#fff;height:100vh;overflow:hidden}#app{display:flex;height:100vh;gap:0}.panel{display:flex;flex-direction:column;background:#252526;border-right:1px solid #3e3e42;transition:width .3s ease}.left-panel{width:250px;min-width:250px}.left-panel.collapsed{width:45px;min-width:45px}#editor-container{flex:1;display:flex;flex-direction:column;min-width:0}.right-panel{width:calc(100% / 3);min-width:calc(100% / 3);border-left:1px solid #3e3e42;transition:width .3s ease}.right-panel.collapsed{width:50px;min-width:50px}.panel-header{display:flex;align-items:center;justify-content:space-between;padding:12px;background:#1e1e1e;border-bottom:1px solid #3e3e42;user-select:none;min-height:45px}.panel-title{font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;overflow:hidden}.left-panel.collapsed .panel-title,.right-panel.collapsed .panel-title{display:none}.collapse-btn{background:0 0;border:none;color:#858585;cursor:pointer;padding:4px 8px;display:flex;align-items:center;justify-content:center;font-size:14px;transition:color .2s;flex-shrink:0;min-width:30px;height:30px}.collapse-btn:hover{color:#fff}.panel-content{flex:1;overflow:hidden;display:flex;flex-direction:column}#files{flex:1;overflow-y:auto;padding:8px}.file-item{padding:10px 8px;margin:4px 0;border-radius:4px;cursor:pointer;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:background .2s;background:#2d2d30;color:#ccc}.file-item:hover{background:#3e3e42;color:#fff}.file-item.active{background:#007acc;color:#fff}#add-file-btn{background:#007acc;border:none;color:#fff;padding:10px;margin:8px;border-radius:4px;cursor:pointer;font-weight:500;transition:background .2s;white-space:nowrap;font-size:13px}#add-file-btn:hover{background:#005a9e}.left-panel.collapsed #add-file-btn{display:none}#preview{width:100%;height:100%;border:none;background:#fff}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);z-index:1000;align-items:center;justify-content:center}.modal.active{display:flex}.modal-content{background:#252526;border:1px solid #3e3e42;border-radius:8px;padding:20px;min-width:400px}.modal-content h3{margin-bottom:15px;color:#ccc}.modal-content input{width:100%;padding:10px;margin-bottom:15px;background:#3c3c3c;border:1px solid #3e3e42;color:#ccc;border-radius:4px;font-size:13px}.modal-content input::placeholder{color:#858585}.modal-buttons{display:flex;gap:10px;justify-content:flex-end}.modal-buttons button{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:background .2s}.btn-cancel{background:#3e3e42;color:#ccc}.btn-cancel:hover{background:#4e4e52}.btn-create{background:#007acc;color:#fff}.btn-create:hover{background:#005a9e}::-webkit-scrollbar{width:10px}::-webkit-scrollbar-track{background:#1e1e1e}::-webkit-scrollbar-thumb{background:#464646;border-radius:5px}::-webkit-scrollbar-thumb:hover{background:#5a5a5a}</style><script src="https://unpkg.com/react@18/umd/react.development.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script></head><body><div id="app"><div class="panel left-panel"id="leftPanel"><div class="panel-header"><span class="panel-title">FILES</span> <button class="collapse-btn"id="leftCollapseBtn"title="–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å">‚óÄ</button></div><div class="panel-content"><div id="files"></div><button id="add-file-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª</button></div></div><div id="editor-container"></div><div class="panel right-panel"id="rightPanel"><div class="panel-header"><span class="panel-title">PREVIEW</span> <button class="collapse-btn"id="rightCollapseBtn"title="–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å">‚ñ∂</button></div><div class="panel-content"><iframe id="preview"></iframe></div></div></div><div id="modal"class="modal"><div class="modal-content"><h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª</h3><input id="fileName"placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Card.tsx"><div class="modal-buttons"><button class="btn-cancel"onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button> <button class="btn-create"onclick="createFile()">–°–æ–∑–¥–∞—Ç—å</button></div></div></div><script>require.config({paths:{vs:"https://unpkg.com/monaco-editor@0.45.0/min/vs"}}),require(["vs/editor/editor.main"],async function(){const e=document.getElementById("leftPanel"),t=document.getElementById("rightPanel"),n=document.getElementById("leftCollapseBtn"),o=document.getElementById("rightCollapseBtn");let c="true"===localStorage.getItem("leftCollapsed"),r="true"===localStorage.getItem("rightCollapsed");c&&(e.classList.add("collapsed"),n.textContent="‚ñ∂"),r&&(t.classList.add("collapsed"),o.textContent="‚óÄ"),n.addEventListener("click",()=>{c=!c,e.classList.toggle("collapsed"),n.textContent=c?"‚ñ∂":"‚óÄ",localStorage.setItem("leftCollapsed",c),setTimeout(()=>d.layout(),300)}),o.addEventListener("click",()=>{r=!r,t.classList.toggle("collapsed"),o.textContent=r?"‚óÄ":"‚ñ∂",localStorage.setItem("rightCollapsed",r),setTimeout(()=>d.layout(),300)});const a=monaco.languages.typescript.typescriptDefaults;async function s(e,t){try{const n=await fetch(e),o=await n.text();a.addExtraLib(o,t)}catch(e){console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–ø–æ–≤ ${t}:`,e)}}a.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ESNext,module:monaco.languages.typescript.ModuleKind.ESNext,moduleResolution:monaco.languages.typescript.ModuleResolutionKind.NodeJs,jsx:monaco.languages.typescript.JsxEmit.React,esModuleInterop:!0,allowSyntheticDefaultImports:!0,strict:!1}),await s("https://unpkg.com/@types/react@18/index.d.ts","file:///node_modules/@types/react/index.d.ts"),await s("https://unpkg.com/@types/react-dom@18/index.d.ts","file:///node_modules/@types/react-dom/index.d.ts"),a.addExtraLib('\ndeclare module "react" {\n  export = React;\n}\ndeclare module "react-dom/client" {\n  export const createRoot: typeof ReactDOM.createRoot;\n}\n        ',"file:///node_modules/custom-global.d.ts");const i={"Test.tsx":'import React from "react";\n\nexport function Test() {\n  return <div style={{ padding: "20px", fontSize: "16px" }}>üëã –ü—Ä–∏–≤–µ—Ç! –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —ç—Ç–æ—Ç —Ñ–∞–π–ª</div>;\n}',"App.tsx":'import React from "react";\nimport { Test } from "./Test";\n\nexport function App() {\n  return (\n    <div>\n      <h1 style={{ backgroundColor: "#007acc", color: "white", margin: 0, padding: "20px" }}>\n        React Sandbox\n      </h1>\n      <Test />\n    </div>\n  );\n}',"index.tsx":'import React from "react";\nimport { createRoot } from "react-dom/client";\nimport { App } from "./App";\n\ncreateRoot(document.getElementById("root")!).render(<App />);'},l={};Object.keys(i).forEach(e=>{const t=monaco.Uri.parse("file:///"+e);l[e]=monaco.editor.createModel(i[e],"typescript",t)});const d=monaco.editor.create(document.getElementById("editor-container"),{model:l["Test.tsx"],theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},fontSize:14,fontFamily:"Menlo, Monaco, 'Courier New', monospace"}),m=document.getElementById("files");let p="Test.tsx";function u(){m.innerHTML="",Object.keys(i).forEach(e=>{if("index.tsx"===e||"App.tsx"===e)return;const t=document.createElement("div");t.className="file-item"+(e===p?" active":""),t.textContent=e,t.onclick=()=>f(e),m.appendChild(t)})}function f(e){document.querySelectorAll(".file-item").forEach(e=>e.classList.remove("active"));const t=Array.from(m.children).find(t=>t.textContent===e);t&&t.classList.add("active"),p=e,d.setModel(l[e])}function g(){try{const e={};Object.keys(l).forEach(t=>{const n=l[t].getValue();e[t]=function(e,t){const n=function(e){const t={},n=e.matchAll(/export\s+(function|const)\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g);for(const e of n)t[e[2]]=e[2];const o=e.matchAll(/export\s*\{\s*([^}]+)\s*\}/g);for(const e of o)e[1].split(",").forEach(e=>{t[e.trim()]=e.trim()});return t}(e);let o=e.replace(/export\s+function\s+/g,"function ").replace(/export\s+const\s+/g,"const ").replace(/export\s+class\s+/g,"class ").replace(/export\s+type\s+/g,"type ").replace(/export\s+interface\s+/g,"interface ").replace(/export\s*\{[^}]*\}/g,"");const c=Babel.transform(o,{filename:t,presets:["typescript",["react",{runtime:"automatic"}]],plugins:[["transform-modules-commonjs",{allowTopLevelThis:!0}]],compact:!1,retainLines:!0}).code;let r=c;Object.keys(n).length>0&&(r=c+"\n"+Object.keys(n).map(e=>`module.exports.${e} = ${e};`).join("\n"));return r}(n,t)});const t={};Object.keys(e).forEach(n=>{const o=n.replace(/\.(tsx?|js)$/,"");t[o]=JSON.stringify(e[n])});const n=`<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <style>\n    * { box-sizing: border-box; }\n    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }\n    #root { min-height: 100vh; }\n  </style>\n</head>\n<body>\n  <div id="root"></div>\n  <script src="https://unpkg.com/react@18/umd/react.development.js"><\/script>\n  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"><\/script>\n  <script>\n    const cache = {};\n    function require(id) {\n      if (id === 'react') return React;\n      if (id === 'react-dom/client') return { createRoot: ReactDOM.createRoot };\n      if (id === 'react/jsx-runtime') return {\n        jsx: React.createElement,\n        jsxs: React.createElement,\n        Fragment: React.Fragment\n      };\n      \n      let normalized = id;\n      if (id.startsWith('./')) normalized = id.slice(2).replace(/\\.(tsx?|js)$/, '');\n      \n      ${Object.keys(t).map(e=>`if (normalized === '${e}') {\n          if (!cache['${e}']) {\n            const m = { exports: {} };\n            (function(exports, module, require) {\n              eval(${t[e]});\n            })(m.exports, m, require);\n            cache['${e}'] = m.exports;\n          }\n          return cache['${e}'];\n        }`).join("\n\n      ")}\n      \n      throw new Error('Unknown module: ' + id);\n    }\n    \n    try {\n      (function() {\n        eval(${t.index});\n      })();\n    } catch (e) {\n      document.getElementById('root').innerHTML = \n        '<div style="color: red; padding: 20px; font-family: monospace; white-space: pre-wrap;">' +\n        '<h3>‚ùå Runtime Error</h3>' +\n        '<pre>' + (e.toString() + '\\n\\n' + e.stack).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])) + '</pre>' +\n        '</div>';\n    }\n  <\/script>\n</body>\n</html>`;document.getElementById("preview").srcdoc=n}catch(e){console.error("Build error:",e);const t=(e.message||String(e)).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[e]));document.getElementById("preview").srcdoc=`\n            <!DOCTYPE html>\n            <html>\n            <head>\n              <style>\n                body { margin: 0; padding: 20px; font-family: monospace; background: #1e1e1e; }\n                pre { color: #f48771; background: #252526; padding: 15px; border-radius: 4px; }\n              </style>\n            </head>\n            <body>\n              <h3 style="color: #ce9178;">‚ùå Compilation Error</h3>\n              <pre>${t}</pre>\n            </body>\n            </html>\n          `}}window.closeModal=function(){document.getElementById("modal").classList.remove("active")},window.createFile=function(){const e=document.getElementById("fileName").value.trim();if(!e)return void alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞");if(i[e])return void alert(`–§–∞–π–ª "${e}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç`);let t="";t=e.endsWith(".tsx")?`import React from "react";\n\nexport function ${e.slice(0,-4)}() {\n  return <div>Hello</div>;\n}`:e.endsWith(".ts")?`// ${e}\n\nexport function myFunction() {\n  return "Hello";\n}`:`// ${e}\n`,i[e]=t;const n=monaco.Uri.parse("file:///"+e);l[e]=monaco.editor.createModel(t,"typescript",n),u(),f(e),closeModal(),g()},document.getElementById("add-file-btn").addEventListener("click",function(){document.getElementById("modal").classList.add("active"),document.getElementById("fileName").focus(),document.getElementById("fileName").value=""}),document.getElementById("fileName").addEventListener("keypress",function(e){"Enter"===e.key&&createFile()}),document.getElementById("modal").addEventListener("click",function(e){e.target===this&&closeModal()}),u(),Object.values(l).forEach(e=>e.onDidChangeContent(()=>{clearTimeout(window.buildTimeout),window.buildTimeout=setTimeout(()=>g(),800)})),g()})</script></body></html>
